<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<title>Minimax and Geekfest // Sandro Padin</title>
<meta name="author" content="Sandro Padin">

<meta http-equiv="cleartype" content="on">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="shortcut icon" href="/link/to/favicon.ico">
<link rel="apple-touch-icon" href="/link/to/apple-touch-icon.png">

<link rel="stylesheet" href="/components/normalize-css/normalize.css" media="all">
<link rel="stylesheet" href="/stylesheets/github.css" media="all">
<link rel="stylesheet" href="/stylesheets/master.css" media="all">
<link rel="alternate" type="application/atom+xml" title="Subscribe to Sandro Padin's blog." href="/atom.xml"/>
<script src="http://dabblet.com/code/prefixfree.min.js"></script>

</head>
<body>
  <header>
    <h1><a href="/">Sandro Padin</a></h1>
  </header>
  <article>
    <header>
      <time pubdate>February 12, 2012</time>
      <h1>Minimax and Geekfest</h1>
      <h2>Completed Minimax algorithm and Clojure talk at Geekfest</h2>
    </header>
    <p>Today I finished debugging my minimax algorithm implementation in
Clojure. I finally figured out the bug in my code. I’d previously been
returning a hash which included the position being returned by the recursive 
call, whereas I should have just been returning the position from the current 
loop iteration. </p>

<p>Here’s the finished simple minimax algorithm:</p>

<div class="highlight"><pre><code class="clojure"><span class="p">(</span><span class="kd">defn </span><span class="nv">min-move</span> <span class="p">[</span><span class="nv">mark</span> <span class="nv">board</span> <span class="nv">depth</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">moves</span>
        <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">position</span> <span class="p">(</span><span class="nf">board/get-empty-indices</span> <span class="nv">board</span><span class="p">)</span>
              <span class="ss">:let</span> <span class="p">[</span><span class="nv">new-board</span> <span class="p">(</span><span class="nf">board/set-mark-at-index</span> <span class="nv">mark</span> <span class="nv">position</span> <span class="nv">board</span><span class="p">)]]</span>
          <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">rules/gameover?</span> <span class="nv">new-board</span><span class="p">)</span>
            <span class="c1">; this is where my bug was</span>
            <span class="p">{</span><span class="ss">:score</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">- </span><span class="mi">-1000</span> <span class="p">(</span><span class="nf">calculate-score</span> <span class="p">(</span><span class="nf">rules/next-player</span> <span class="nv">mark</span><span class="p">)</span> <span class="nv">new-board</span><span class="p">))</span> <span class="nv">depth</span><span class="p">)</span>
             <span class="ss">:position</span> <span class="nv">position</span><span class="p">}</span>
            <span class="p">{</span><span class="ss">:score</span> <span class="p">(</span><span class="ss">:score</span> <span class="p">(</span><span class="nf">max-move</span> <span class="p">(</span><span class="nf">rules/next-player</span> <span class="nv">mark</span><span class="p">)</span> <span class="nv">new-board</span> <span class="p">(</span><span class="nb">inc </span><span class="nv">depth</span><span class="p">)))</span>
             <span class="ss">:position</span> <span class="nv">position</span><span class="p">}))]</span>
    <span class="p">(</span><span class="nb">reduce </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">memo</span> <span class="nv">val</span><span class="p">]</span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="ss">:score</span> <span class="nv">val</span><span class="p">)</span> <span class="p">(</span><span class="ss">:score</span> <span class="nv">memo</span><span class="p">))</span> <span class="nb">val </span><span class="nv">memo</span><span class="p">))</span> <span class="nv">moves</span><span class="p">)))</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">max-move</span> <span class="p">[</span><span class="nv">mark</span> <span class="nv">board</span> <span class="nv">depth</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">moves</span>
        <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">position</span> <span class="p">(</span><span class="nf">board/get-empty-indices</span> <span class="nv">board</span><span class="p">)</span>
              <span class="ss">:let</span> <span class="p">[</span><span class="nv">new-board</span> <span class="p">(</span><span class="nf">board/set-mark-at-index</span> <span class="nv">mark</span> <span class="nv">position</span> <span class="nv">board</span><span class="p">)]]</span>
          <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">rules/gameover?</span> <span class="nv">new-board</span><span class="p">)</span>
            <span class="c1">; this is where my bug was</span>
            <span class="p">{</span><span class="ss">:score</span> <span class="p">(</span><span class="nb">- </span><span class="mi">1000</span> <span class="p">(</span><span class="nf">calculate-score</span> <span class="nv">mark</span> <span class="nv">new-board</span><span class="p">)</span> <span class="nv">depth</span><span class="p">)</span>
             <span class="ss">:position</span> <span class="nv">position</span><span class="p">}</span>
            <span class="p">{</span><span class="ss">:score</span> <span class="p">(</span><span class="ss">:score</span> <span class="p">(</span><span class="nf">min-move</span> <span class="p">(</span><span class="nf">rules/next-player</span> <span class="nv">mark</span><span class="p">)</span> <span class="nv">new-board</span> <span class="p">(</span><span class="nb">inc </span><span class="nv">depth</span><span class="p">)))</span>
             <span class="ss">:position</span> <span class="nv">position</span><span class="p">}))]</span>
    <span class="p">(</span><span class="nb">reduce </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">memo</span> <span class="nv">val</span><span class="p">]</span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="ss">:score</span> <span class="nv">val</span><span class="p">)</span> <span class="p">(</span><span class="ss">:score</span> <span class="nv">memo</span><span class="p">))</span> <span class="nb">val </span><span class="nv">memo</span><span class="p">))</span> <span class="nv">moves</span><span class="p">)))</span>
</code></pre></div>

<p><br />
This algorithm isn’t quite complete. It’s slow and not as smart as it can be. I’ll be 
refactoring the algorithm to use <a href="http://en.wikipedia.org/wiki/Alpha%E2%80%93beta_pruning">Alpha-beta pruning</a> tomorrow.</p>

<p>I took a break during lunch to go to my first <a href="http://www.meetup.com/Geekfest/">Geekfest</a>. The topic today
was Clojure which was cool as I’ve been working with it so
much lately. The talk focused on ways to define macros and arguments 
for and against using macros. Overall it was an interesting talk although a bit 
complicated at points. I don’t really see myself applying what I learned
about macros anytime soon, but I enjoyed the talk.</p>


  </article>
  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-21225209-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>

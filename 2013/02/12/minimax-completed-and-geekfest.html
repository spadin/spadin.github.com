<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Minimax and Geekfest // Sandro Padin</title>
<meta name="description" content="A blog by a resident apprentice at 8th Light">
<meta name="author" content="Sandro Padin">

<!-- /ht Andy Clarke - http://front.ie/lkCwyf -->
<meta http-equiv="cleartype" content="on">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
  
<link rel="shortcut icon" href="/link/to/favicon.ico">
<link rel="apple-touch-icon" href="/link/to/apple-touch-icon.png">

<!-- Stylesheets -->
<link rel="stylesheet" href="/stylesheets/base.css" media="all">
<link rel="stylesheet" href="/stylesheets/module.css" media="all">
<link rel="stylesheet" href="/stylesheets/state.css" media="all">
<link rel="stylesheet" href="/stylesheets/github.css" media="all">

<!-- /ht Jeremy Keith - http://front.ie/mLXiaS -->
<link rel="stylesheet" href="/stylesheets/layout.css" media="all and (min-width: 33.236em)">
<link rel="alternate" type="application/atom+xml" title="Subscribe to Sandro Padin's blog." href="/atom.xml"/>
<!-- 30em + (1.618em * 2) = 33.236em / Eliminates potential of horizontal scrolling in most cases -->

<script src="/js/libs/modernizr-1.7.min.js"></script>
<!--<script type="text/javascript" src="http://use.typekit.com/yks8igg.js"></script>-->
<!--<script type="text/javascript">try{Typekit.load();}catch(e){}</script>-->
</head>
<body>
  <header>
    <div class="container">
      <h2 class="m-site-title">
        <a href="/index.html">Sandro Padin</a>
      </h2>
      <section>
        <p class="m-post-date">
          February 12, 2012
        </p>
        <h1 class="m-post-title">
          Minimax and Geekfest
        </h1> 
        <h2 class="m-post-subtitle">
          Completed Minimax algorithm and Clojure talk at Geekfest
        </h2>
      </section>
    </div>
  </header>
  
  <div id="summary">
    <div class="container cf">
      <article>
        <p>Today I finished debugging my minimax algorithm implementation in
Clojure. I finally figured out the bug in my code. I’d previously been
returning a hash which included the position being returned by the recursive 
call, whereas I should have just been returning the position from the current 
loop iteration. </p>

<p>Here’s the finished simple minimax algorithm:</p>

<div class="highlight"><pre><code class="clojure"><span class="p">(</span><span class="kd">defn </span><span class="nv">min-move</span> <span class="p">[</span><span class="nv">mark</span> <span class="nv">board</span> <span class="nv">depth</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">moves</span>
        <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">position</span> <span class="p">(</span><span class="nf">board/get-empty-indices</span> <span class="nv">board</span><span class="p">)</span>
              <span class="ss">:let</span> <span class="p">[</span><span class="nv">new-board</span> <span class="p">(</span><span class="nf">board/set-mark-at-index</span> <span class="nv">mark</span> <span class="nv">position</span> <span class="nv">board</span><span class="p">)]]</span>
          <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">rules/gameover?</span> <span class="nv">new-board</span><span class="p">)</span>
            <span class="c1">; this is where my bug was</span>
            <span class="p">{</span><span class="ss">:score</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">- </span><span class="mi">-1000</span> <span class="p">(</span><span class="nf">calculate-score</span> <span class="p">(</span><span class="nf">rules/next-player</span> <span class="nv">mark</span><span class="p">)</span> <span class="nv">new-board</span><span class="p">))</span> <span class="nv">depth</span><span class="p">)</span>
             <span class="ss">:position</span> <span class="nv">position</span><span class="p">}</span>
            <span class="p">{</span><span class="ss">:score</span> <span class="p">(</span><span class="ss">:score</span> <span class="p">(</span><span class="nf">max-move</span> <span class="p">(</span><span class="nf">rules/next-player</span> <span class="nv">mark</span><span class="p">)</span> <span class="nv">new-board</span> <span class="p">(</span><span class="nb">inc </span><span class="nv">depth</span><span class="p">)))</span>
             <span class="ss">:position</span> <span class="nv">position</span><span class="p">}))]</span>
    <span class="p">(</span><span class="nb">reduce </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">memo</span> <span class="nv">val</span><span class="p">]</span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="ss">:score</span> <span class="nv">val</span><span class="p">)</span> <span class="p">(</span><span class="ss">:score</span> <span class="nv">memo</span><span class="p">))</span> <span class="nb">val </span><span class="nv">memo</span><span class="p">))</span> <span class="nv">moves</span><span class="p">)))</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">max-move</span> <span class="p">[</span><span class="nv">mark</span> <span class="nv">board</span> <span class="nv">depth</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">moves</span>
        <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">position</span> <span class="p">(</span><span class="nf">board/get-empty-indices</span> <span class="nv">board</span><span class="p">)</span>
              <span class="ss">:let</span> <span class="p">[</span><span class="nv">new-board</span> <span class="p">(</span><span class="nf">board/set-mark-at-index</span> <span class="nv">mark</span> <span class="nv">position</span> <span class="nv">board</span><span class="p">)]]</span>
          <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">rules/gameover?</span> <span class="nv">new-board</span><span class="p">)</span>
            <span class="c1">; this is where my bug was</span>
            <span class="p">{</span><span class="ss">:score</span> <span class="p">(</span><span class="nb">- </span><span class="mi">1000</span> <span class="p">(</span><span class="nf">calculate-score</span> <span class="nv">mark</span> <span class="nv">new-board</span><span class="p">)</span> <span class="nv">depth</span><span class="p">)</span>
             <span class="ss">:position</span> <span class="nv">position</span><span class="p">}</span>
            <span class="p">{</span><span class="ss">:score</span> <span class="p">(</span><span class="ss">:score</span> <span class="p">(</span><span class="nf">min-move</span> <span class="p">(</span><span class="nf">rules/next-player</span> <span class="nv">mark</span><span class="p">)</span> <span class="nv">new-board</span> <span class="p">(</span><span class="nb">inc </span><span class="nv">depth</span><span class="p">)))</span>
             <span class="ss">:position</span> <span class="nv">position</span><span class="p">}))]</span>
    <span class="p">(</span><span class="nb">reduce </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">memo</span> <span class="nv">val</span><span class="p">]</span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="ss">:score</span> <span class="nv">val</span><span class="p">)</span> <span class="p">(</span><span class="ss">:score</span> <span class="nv">memo</span><span class="p">))</span> <span class="nb">val </span><span class="nv">memo</span><span class="p">))</span> <span class="nv">moves</span><span class="p">)))</span>
</code></pre></div>

<p><br />
This algorithm isn’t quite complete. It’s slow and not as smart as it can be. I’ll be 
refactoring the algorithm to use <a href="http://en.wikipedia.org/wiki/Alpha%E2%80%93beta_pruning">Alpha-beta pruning</a> tomorrow.</p>

<p>I took a break during lunch to go to my first <a href="http://www.meetup.com/Geekfest/">Geekfest</a>. The topic today
was Clojure which was cool as I’ve been working with it so
much lately. The talk focused on ways to define macros and arguments 
for and against using macros. Overall it was an interesting talk although a bit 
complicated at points. I don’t really see myself applying what I learned
about macros anytime soon, but I enjoyed the talk.</p>


      </article>
    </div>
  </div>

  <footer class="clearfix">
    <div class="container">
      <div class="column">
        <h3>Find Me</h3>
        <a href="http://twitter.com/sandropadin"><img alt="twitter" src="/images/twitter.png"></a>
        <a href="http://sa.ndropad.in/atom.xml"><img alt="rss" src="/images/rss.png"></a>
      </div>

      <div class="column">
        <h3>About Me</h3>
        <p>
          Resident apprentice at<br>
          <a href="http://www.8thlight.com">8th Light, Inc</a>
        </p>
      </div>
    </div>
  </footer>
</body>
</html>
